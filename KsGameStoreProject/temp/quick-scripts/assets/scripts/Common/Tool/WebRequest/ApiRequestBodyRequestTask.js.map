{"version":3,"sources":["ApiRequestBodyRequestTask.js"],"names":["BaseWebRequestTask","require","ApiRequestBodyRequestTask","url","params","callback","xhr","getXMLHttpRequest","onreadystatechange","_onReadyStateChange","ontimeout","e","_onTimeOut","onerror","_onError","open","send","readyState","status","responseText","console","log","respInfo","getRepsonseBody","error","JSON","stringify","module","exports"],"mappings":";;;;;;;;;;;;;;AAAA,IAAMA,qBAAqBC,QAAQ,oBAAR,CAA3B;;IAEMC;;;AAEF,uCAAYC,GAAZ,EACA;AAAA,YADiBC,MACjB,uEAD0B,IAC1B;AAAA,YADgCC,QAChC;;AAAA;;AAAA,qJACUF,GADV,EACeC,MADf,EACuBC,QADvB;AAEC;;;;iCAGQ;AAAA;;AACL,gBAAIC,MAAM,KAAKC,iBAAL,CAAuB,IAAvB,CAAV;;AAEAD,gBAAIE,kBAAJ,GAAyB,YAAM;AAAE,uBAAKC,mBAAL,CAAyBH,GAAzB;AAAgC,aAAjE;AACAA,gBAAII,SAAJ,GAAgB,UAACC,CAAD,EAAO;AAAE,uBAAKC,UAAL,CAAgBD,CAAhB;AAAqB,aAA9C;AACAL,gBAAIO,OAAJ,GAAc,UAACF,CAAD,EAAO;AAAE,uBAAKG,QAAL,CAAcH,CAAd;AAAmB,aAA1C;;AAEAL,gBAAIS,IAAJ,CAAS,MAAT,EAAgB,KAAKZ,GAArB;AACAG,gBAAIU,IAAJ,CAAS,KAAKZ,MAAd;AACH;;;4CAGmBE,KAAI;AACpB,gBAAIA,IAAIW,UAAJ,KAAmB,CAAnB,IAAyBX,IAAIY,MAAJ,IAAc,GAAd,IAAqBZ,IAAIY,MAAJ,GAAa,GAA/D,EAAqE;AACjE,oBAAIC,eAAeb,IAAIa,YAAvB;AACAC,wBAAQC,GAAR,mEAAwDF,YAAxD;;AAEA,oBAAI,KAAKd,QAAL,KAAkB,IAAtB,EAA4B;AACxB,wBAAIiB,WAAW,KAAKC,eAAL,CAAqB,CAArB,EAAwBJ,YAAxB,CAAf;AACA,yBAAKd,QAAL,CAAciB,QAAd;AACH;AAEJ;AACJ;;AAED;;;;;;;;mCAKWE,OAAM;AACbJ,oBAAQC,GAAR,uEAAkDG,KAAlD;AACA,gBAAI,KAAKnB,QAAL,KAAkB,IAAtB,EACA;AACI,oBAAIiB,WAAW,KAAKC,eAAL,CAAqB,CAArB,EAAwB,IAAxB,CAAf;AACA,qBAAKlB,QAAL,CAAciB,QAAd;AACH;AACJ;;AAED;;;;;;;;iCAKSE,OACT;AACIJ,oBAAQC,GAAR,uEAAkDI,KAAKC,SAAL,CAAeF,KAAf,CAAlD;AACA,gBAAI,KAAKnB,QAAL,KAAkB,IAAtB,EACA;AACI,oBAAIiB,WAAW,KAAKC,eAAL,CAAqB,CAArB,EAAwB,MAAxB,CAAf;AACA,qBAAKlB,QAAL,CAAciB,QAAd;AACH;AACJ;;;;EA5DmCtB,qBA8DvC;;;AAGD2B,OAAOC,OAAP,GAAiB1B,yBAAjB","file":"ApiRequestBodyRequestTask.js","sourceRoot":"../../../../../../../assets/scripts/Common/Tool/WebRequest","sourcesContent":["const BaseWebRequestTask = require('BaseWebRequestTask');\n\nclass ApiRequestBodyRequestTask extends BaseWebRequestTask\n{\n    constructor(url, params = null, callback)\n    {\n        super(url, params, callback);\n    }\n\n\n    doPost() {\n        let xhr = this.getXMLHttpRequest(true);\n\n        xhr.onreadystatechange = () => { this._onReadyStateChange(xhr); };\n        xhr.ontimeout = (e) => { this._onTimeOut(e); };\n        xhr.onerror = (e) => { this._onError(e); };\n\n        xhr.open(\"POST\",this.url);\n        xhr.send(this.params);\n    }\n\n\n    _onReadyStateChange(xhr){\n        if (xhr.readyState === 4 && (xhr.status >= 200 && xhr.status < 400)) {\n            let responseText = xhr.responseText;\n            console.log(`[[ApiRequestBodyRequestTask]请求响应Response:${responseText}]`);\n\n            if (this.callback !== null) {\n                let respInfo = this.getRepsonseBody(0, responseText);\n                this.callback(respInfo);\n            }\n\n        }\n    }\n\n    /**\n     * 请求超时回调\n     * @param error\n     * @private\n     */\n    _onTimeOut(error){\n        console.log(`[[ApiRequestBodyRequestTask]请求发生超时:${error}]`);\n        if (this.callback !== null)\n        {\n            let respInfo = this.getRepsonseBody(1, \"超时\");\n            this.callback(respInfo);\n        }\n    }\n\n    /**\n     * 网络错误回调\n     * @param error\n     * @private\n     */\n    _onError(error)\n    {\n        console.log(`[[ApiRequestBodyRequestTask]请求发生错误:${JSON.stringify(error)}]`);\n        if (this.callback !== null)\n        {\n            let respInfo = this.getRepsonseBody(2, \"网络错误\");\n            this.callback(respInfo);\n        }\n    }\n\n}//end class\n\n\nmodule.exports = ApiRequestBodyRequestTask;\n\n"]}