{"version":3,"sources":["LauncherViewController.js"],"names":["require","ResourceList","EnvConfig","Env_Config_Type","RES_TYPE","KSProjectAppDelegate","BaseViewController","SceneMgr","DialogMgr","cc","Class","extends","properties","bgm","AudioClip","_monkeyOriginX","_currentLoadingIndex","_currentLoadingProgress","getHandleNotificationList","ss","TagConst","TAG_LAUNCHER_GAME_INITIALIZE_INFO_COMPLETE","TAG_LAUNCHER_LOADING_PROGRESS","TAG_SHOW_NET_ERROR_DIALOG","onNotification","notification","name","getName","_onCompleteGameInitializeInfoComplete","getBody","_showNetErrorDialog","_handleLoadingProgress","loadingProgressValue","_setLoadingProgress","data","console","log","JSON","stringify","volumeValue","localStorage","isBgmOpen","userInfoCache","userId","audioUtil","playBgm","reportPointUtil","reportGameStoreEnterLauncherShowEvent","_handleLaunchCompleteData","_enterGameScene","_isNeedToMedalListScene","rlt","enterGameSceneType","undefined","ToGameStore","serverData","lifeSystemMgr","lazyInit","parseInt","hp","recoverLifeSeconds","startUp","systemMgr","proxyType","GlobalConst","PROXY_LAUNCHER_CONTROLLER","showNetErrorDialog","find","NET_ERROR_ALERT_TYPE","ALERT_COMMON","_requestGameInitInfo","nativeUtil","backToNative","sys","os","start","node","active","onLoad","appDelegate","setupApplication","setControllerName","NameConst","NAME_CONTROLLER_LAUNCHER","Facade","registerController","_initUI","isDeveloping","Debug","getChildByName","userName","headIconURL","httpRequestToken","loadNativeInfo","_loadGameResources","testStartBtn","on","event","userIdInput","uiUtil","findNodeByPathName","inputStr","getComponent","EditBox","string","monkey","x","_setVersionLabel","_loadRes","length","res","resPath","path","resType","type","assetType","RES_TYPE_IMAGE","Texture2D","RES_TYPE_AUDIO","progressCallback","num","totalNum","item","subProgress","completeCallback","err","assets","loader","loadResDir","proxy","getProxy","NAME_PROXY_LAUNCHER","requestGameInitializeInfo","progress","progressComp","ProgressBar","bar","width","versionText","envMode","EnvMode","Env_Config_Type_Test","getItem","Env_Config_Type_Gamma","Env_Config_Type_Release","Env_Config_Type_Dev","Label","isIphoneXsOrAllScreen","Widget","bottom","left","updateAlignment","onDestroy","removeController"],"mappings":"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","file":"LauncherViewController.js","sourceRoot":"../../../../../../../../assets/scripts/GameModule/Launcher/Module/ViewController","sourcesContent":["const {ResourceList, EnvConfig, Env_Config_Type, RES_TYPE} = require('GameConfig');\nconst KSProjectAppDelegate = require('KsProjectAppDelegate');\n\nconst BaseViewController = require(\"BaseViewController\");\n\nconst SceneMgr = require('SceneMgr');\nconst DialogMgr = require('DialogMgr');\n\n\ncc.Class({\n    extends: BaseViewController,\n\n    properties: {\n        bgm: cc.AudioClip,\n\n        _monkeyOriginX: 0,\n        _currentLoadingIndex: 0,\n        _currentLoadingProgress: 0,\n    },\n\n    getHandleNotificationList: function () {\n        return [cc.ss.TagConst.TAG_LAUNCHER_GAME_INITIALIZE_INFO_COMPLETE,\n            cc.ss.TagConst.TAG_LAUNCHER_LOADING_PROGRESS,\n            cc.ss.TagConst.TAG_SHOW_NET_ERROR_DIALOG];\n    },\n\n    //接受通知\n    onNotification: function (notification) {\n        let name = notification.getName();\n\n        if (name === cc.ss.TagConst.TAG_LAUNCHER_GAME_INITIALIZE_INFO_COMPLETE) {\n            this._onCompleteGameInitializeInfoComplete(notification.getBody());\n        }else if (name === cc.ss.TagConst.TAG_SHOW_NET_ERROR_DIALOG) {\n            this._showNetErrorDialog(notification.getBody());\n        }else if (name === cc.ss.TagConst.TAG_LAUNCHER_LOADING_PROGRESS) {\n            this._handleLoadingProgress(notification.getBody());\n        }\n\n    },\n\n    _handleLoadingProgress(loadingProgressValue)\n    {\n        this._currentLoadingProgress += loadingProgressValue;\n        this._setLoadingProgress(this._currentLoadingProgress);\n    },\n\n    _onCompleteGameInitializeInfoComplete(data) {\n        console.log(`[LauncherViewController]初始化数据完成:${JSON.stringify(data)}`);\n        this._setLoadingProgress(1);\n\n        let volumeValue = cc.ss.localStorage.isBgmOpen(cc.ss.userInfoCache.userId) ? 1 : 0;\n        cc.ss.audioUtil.playBgm(this.bgm, volumeValue);\n\n        //2018年11月19添加打点\n        cc.ss.reportPointUtil.reportGameStoreEnterLauncherShowEvent();\n\n        this._handleLaunchCompleteData(data);\n        this._enterGameScene();\n    },\n\n    /**\n     * 是否需要进入勋章列表界面\n     * @returns {boolean}\n     * @private\n     */\n    _isNeedToMedalListScene()\n    {\n        let rlt = false;\n        let enterGameSceneType = cc.ss.userInfoCache.enterGameSceneType;\n        if (enterGameSceneType === null || enterGameSceneType === undefined || enterGameSceneType === \"\"){\n            rlt = false;\n        }else {\n            rlt = enterGameSceneType === 1;\n        }\n\n        return rlt;\n    },\n\n    _enterGameScene()\n    {\n        // if (this._isNeedToMedalListScene())\n        // {\n        //     console.log(\"[LauncherViewController]进入勋章中心\");\n        //     SceneMgr.ToMedalList();\n        // }else {\n        //     console.log(\"[LauncherViewController]进入World地图场景\");\n        //     SceneMgr.ToWorld();\n        // }\n        console.log(\"[LauncherViewController]进入星星商城场景\");\n        SceneMgr.ToGameStore();\n    },\n\n    _handleLaunchCompleteData(serverData)\n    {\n        cc.ss.lifeSystemMgr.lazyInit(cc.ss.userInfoCache.userId, parseInt(serverData.hp), parseInt(serverData.recoverLifeSeconds) * 1000 );\n        cc.ss.lifeSystemMgr.startUp();\n        cc.ss.systemMgr.startUp();\n\n    },\n\n    _showNetErrorDialog(data)\n    {\n        if (data.proxyType === cc.ss.GlobalConst.PROXY_LAUNCHER_CONTROLLER)\n        {\n            DialogMgr.showNetErrorDialog(cc.find('Canvas'), cc.ss.GlobalConst.NET_ERROR_ALERT_TYPE.ALERT_COMMON, () => {\n                this._requestGameInitInfo();\n            }, () =>{ //退出\n                cc.ss.nativeUtil.backToNative(cc.sys.os);\n            });\n        }\n\n    },\n\n    start()\n    {\n        cc.find('loadingBar/loadingProgress/monkey', this.node).active = !this._isNeedToMedalListScene();\n    },\n\n\n    // use this for initialization\n    onLoad: function () {\n        let appDelegate = new KSProjectAppDelegate(); //初始化引擎\n        appDelegate.setupApplication();//初始化引擎参数\n\n        this.setControllerName(cc.ss.NameConst.NAME_CONTROLLER_LAUNCHER);\n        cc.ss.Facade.registerController(this);\n\n        this._initUI();\n\n        let isDeveloping = EnvConfig.Debug;\n        if (isDeveloping === true) {//开发模式显示输入userId的输入框\n            console.log('[LaunchViewController]开启游戏开发调试模式');\n\n            this.node.getChildByName(\"userIdInput\").active = true;//显示输入框\n            //设置测试用数据\n            cc.ss.userInfoCache.userName = '小美';\n            cc.ss.userInfoCache.headIconURL = \"http://wx.qlogo.cn/mmopen/vi_32/DYAIOgq83erygibDSibV2gvoasia1SEEc0ic6dksftprOsUpicFxmmmziahicJCDqH8QwZZZ5hkgsZ2m2LeVLH6brQFXw/0\";\n            cc.ss.httpRequestToken = '{\\\\\"to\\\\\":2495013475544,\\\\\"rd\\\\\":\\\\\"481495013476544\\\\\",\\\\\"il\\\\\":false,\\\\\"aid\\\\\":\\\\\"123456\\\\\"}|REU2NEM4NEQ0RDVBMkYxQTM0MjVDMzUwQkFCRDE2Q0Q=';\n\n        } else {//正式模式\n            console.log('[LaunchViewController]开启游戏发布模式');\n            appDelegate.loadNativeInfo(); //加载读取Native端数据\n\n            this.node.getChildByName(\"userIdInput\").active = false;//隐藏输入框\n            this._loadGameResources();//加载资源\n        }\n\n    },\n\n    _initUI()\n    {\n\n        let testStartBtn = cc.find('testStartBtn', this.node);\n        testStartBtn.on('click', (event) => {\n            console.log('点击测试开始登录按钮');\n            if (EnvConfig.Debug === true) {\n                let userIdInput = cc.ss.uiUtil.findNodeByPathName(this.node, \"userIdInput\");\n                let inputStr = userIdInput.getComponent(cc.EditBox).string;\n                userIdInput.active = false;\n                console.log(\"[LauncherViewController]用户输入测试用UserId:\" + inputStr);\n                cc.ss.userInfoCache.userId = inputStr;\n            }\n\n            this._loadGameResources(); //加载图片资源\n        });\n\n        let monkey = cc.find('loadingBar/loadingProgress/monkey', this.node);\n        this._monkeyOriginX = monkey.x;\n\n        this._setVersionLabel();//设置版本号\n    },\n\n    _loadGameResources()\n    {\n        this.node.getChildByName(\"loadingBar\").active = true;\n        this.node.getChildByName(\"testStartBtn\").active = false;\n        console.log(\"[LauncherViewController]开始加载资源\");\n        this._loadRes();\n    },\n\n\n    _loadRes() {\n        if (this._currentLoadingIndex >= ResourceList.length) {\n            console.log(`[LauncherViewController]资源全部加载完成,请求服务器判断`);\n            this._requestGameInitInfo();\n            return;\n        }\n\n        let res = ResourceList[this._currentLoadingIndex];\n        let resPath = res.path;\n        let resType = res.type;\n\n        let assetType = null;\n        if (resType === RES_TYPE.RES_TYPE_IMAGE) {\n            assetType = cc.Texture2D;\n        } else if (resType === RES_TYPE.RES_TYPE_AUDIO) {\n            assetType = cc.AudioClip;\n        }\n\n        let progressCallback = (num, totalNum, item) => {\n            if (num !== 0 && totalNum !== 0) {\n                let subProgress = (num / totalNum);\n                subProgress = subProgress * (1 / ResourceList.length) / 2;\n                this._setLoadingProgress(this._currentLoadingProgress + subProgress);\n                if (num === totalNum) { this._currentLoadingProgress += subProgress; }\n            }\n\n        };\n\n        let completeCallback = (err, assets) => {\n            console.log(`[LauncherViewController]${resPath}加载完成`);\n            this._currentLoadingIndex++;\n            this._loadRes();\n        };\n\n        cc.loader.loadResDir(resPath, assetType, progressCallback, completeCallback);\n\n    },\n\n    /**\n     * 请求游戏初始化信息\n     * @private\n     */\n    _requestGameInitInfo() {\n        console.log('[LauncherViewController]请求游戏初始化信息');\n        let proxy = cc.ss.Facade.getProxy(cc.ss.NameConst.NAME_PROXY_LAUNCHER);\n        proxy.requestGameInitializeInfo(cc.ss.userInfoCache.userId);\n    },\n\n\n    /**\n     * 设置加载进度\n     * @param progress\n     * @private\n     */\n    _setLoadingProgress(progress) {\n        let progressComp = cc.find('loadingBar/loadingProgress', this.node).getComponent(cc.ProgressBar);\n        progressComp.progress = progress;\n\n        let bar = cc.find('loadingBar/loadingProgress/bar', this.node);\n        let monkey = cc.find('loadingBar/loadingProgress/monkey', this.node);\n        monkey.x = this._monkeyOriginX + bar.width * progress;\n    },\n    /**\n     * 设置版本号\n     * @private\n     */\n    _setVersionLabel: function () {\n        let versionText = \"1.0.0\";\n        let envMode = EnvConfig.EnvMode;//开发环境版本号使用和测试环境\n        if (envMode === Env_Config_Type.Env_Config_Type_Test) versionText = cc.sys.localStorage.getItem(\"debug_KsGameStoreLocalVersion\");\n         else if (envMode === Env_Config_Type.Env_Config_Type_Gamma) versionText = cc.sys.localStorage.getItem(\"gamma_KsGameStoreLocalVersion\");\n         else if (envMode === Env_Config_Type.Env_Config_Type_Release) versionText = cc.sys.localStorage.getItem(\"release_KsGameStoreLocalVersion\");\n        else if (envMode === Env_Config_Type.Env_Config_Type_Dev) versionText = cc.sys.localStorage.getItem(\"dev_KsGameStoreLocalVersion\");\n\n        if (versionText === null || versionText === undefined) versionText = \"1.0.0\";\n        this.node.getChildByName(\"versionLabel\").getComponent(cc.Label).string = \"version:\" + versionText;\n        //范林松于2018年11月13日 添加IPhoneX的 homeIndicator 的安全距离\n        if(this.node.getComponent(\"FitScreenComponent\").isIphoneXsOrAllScreen()){\n            this.node.getChildByName(\"versionLabel\").getComponent(cc.Widget).bottom = 60;\n            this.node.getChildByName(\"versionLabel\").getComponent(cc.Widget).left = 40;\n            this.node.getChildByName(\"versionLabel\").getComponent(cc.Widget).updateAlignment();\n        }\n    },\n\n    onDestroy: function () { cc.ss.Facade.removeController(this); }\n\n});\n"]}