{"version":3,"sources":["../../../../../../../assets/scripts/Common/Tool/WebRequest/assets/scripts/Common/Tool/WebRequest/ReportPointRequestTask.js"],"names":["BaseWebRequestTask","require","ReportPointRequestTask","url","params","callback","console","log","xhr","getXMLHttpRequest","onreadystatechange","_onReadyStateChange","ontimeout","e","_onTimeOut","onerror","_onError","open","send","readyState","status","responseText","resBody","infoCode","data","error","module","exports"],"mappings":";;;;;;;;;;;;;;AAAA,IAAMA,qBAAqBC,QAAQ,oBAAR,CAA3B;;IAEMC;;;AAEF,oCAAYC,GAAZ,EACA;AAAA,YADiBC,MACjB,uEAD0B,IAC1B;AAAA,YADgCC,QAChC;;AAAA;;AAAA,+IACUF,GADV,EACeC,MADf,EACuBC,QADvB;AAEC;;;;iCAGQ;AAAA;;AACLC,oBAAQC,GAAR;;AAEA,gBAAIC,MAAM,KAAKC,iBAAL,CAAuB,IAAvB,CAAV;;AAEAD,gBAAIE,kBAAJ,GAAyB,YAAM;AAAE,uBAAKC,mBAAL,CAAyBH,GAAzB;AAAgC,aAAjE;AACAA,gBAAII,SAAJ,GAAgB,UAACC,CAAD,EAAO;AAAE,uBAAKC,UAAL,CAAgBD,CAAhB;AAAqB,aAA9C;AACAL,gBAAIO,OAAJ,GAAc,UAACF,CAAD,EAAO;AAAE,uBAAKG,QAAL,CAAcH,CAAd;AAAmB,aAA1C;;AAEAL,gBAAIS,IAAJ,CAAS,MAAT,EAAiB,KAAKd,GAAtB;AACAK,gBAAIU,IAAJ,CAAS,KAAKd,MAAd;AACH;;;4CAEmBI,KAAK;AACrB,gBAAIA,IAAIW,UAAJ,KAAmB,CAAnB,IAAyBX,IAAIY,MAAJ,IAAc,GAAd,IAAqBZ,IAAIY,MAAJ,GAAa,GAA/D,EAAqE;AACjE,oBAAIC,eAAeb,IAAIa,YAAvB;AACAf,wBAAQC,GAAR,4EAAuDc,YAAvD;;AAEA,oBAAI,KAAKhB,QAAL,KAAkB,IAAtB,EAA4B;AACxB,wBAAIiB,UAAU,EAAd;AACAA,4BAAQC,QAAR,GAAmB,CAAnB;AACAD,4BAAQE,IAAR,GAAeH,YAAf;AACA,yBAAKhB,QAAL,CAAciB,OAAd;AACH;AAEJ;AACJ;;AAED;;;;;;;;mCAKWG,OAAO;AACdnB,oBAAQC,GAAR,oEAA+CkB,KAA/C;AACA,gBAAI,KAAKpB,QAAL,KAAkB,IAAtB,EAA4B;AACxB,oBAAIiB,UAAU,EAAd;AACAA,wBAAQC,QAAR,GAAmB,CAAnB,CAFwB,CAEF;AACtBD,wBAAQE,IAAR,GAAe,IAAf;;AAEA,qBAAKnB,QAAL,CAAciB,OAAd;AACH;AACJ;;AAED;;;;;;;;iCAKSG,OAAO;AACZnB,oBAAQC,GAAR,oEAA+CkB,KAA/C;AACA,gBAAI,KAAKpB,QAAL,KAAkB,IAAtB,EAA4B;AACxB,oBAAIiB,UAAU,EAAd;AACAA,wBAAQC,QAAR,GAAmB,CAAnB,CAFwB,CAEF;AACtBD,wBAAQE,IAAR,GAAe,MAAf;;AAEA,qBAAKnB,QAAL,CAAciB,OAAd;AACH;AACJ;;;;EAlEgCtB;;AAqErC0B,OAAOC,OAAP,GAAiBzB,sBAAjB","file":"ReportPointRequestTask.js","sourceRoot":"../../../../../../../assets/scripts/Common/Tool/WebRequest","sourcesContent":["const BaseWebRequestTask = require('BaseWebRequestTask');\n\nclass ReportPointRequestTask extends BaseWebRequestTask\n{\n    constructor(url, params = null, callback)\n    {\n        super(url, params, callback);\n    }\n\n\n    doPost() {\n        console.log(`[ReportPointRequestTask]打点Post`);\n\n        let xhr = this.getXMLHttpRequest(true);\n\n        xhr.onreadystatechange = () => { this._onReadyStateChange(xhr); };\n        xhr.ontimeout = (e) => { this._onTimeOut(e); };\n        xhr.onerror = (e) => { this._onError(e); };\n\n        xhr.open(\"POST\", this.url);\n        xhr.send(this.params);\n    }\n\n    _onReadyStateChange(xhr) {\n        if (xhr.readyState === 4 && (xhr.status >= 200 && xhr.status < 400)) {\n            let responseText = xhr.responseText;\n            console.log(`[[ReportPointRequestTask]打点请求响应Response:${responseText}]`);\n\n            if (this.callback !== null) {\n                let resBody = {};\n                resBody.infoCode = 0;\n                resBody.data = responseText;\n                this.callback(resBody);\n            }\n\n        }\n    }\n\n    /**\n     * 请求超时回调\n     * @param error\n     * @private\n     */\n    _onTimeOut(error) {\n        console.log(`[[ReportPointRequestTask]请求发生超时:${error}]`);\n        if (this.callback !== null) {\n            let resBody = {};\n            resBody.infoCode = 1; //超时\n            resBody.data = \"超时\";\n\n            this.callback(resBody);\n        }\n    }\n\n    /**\n     * 网络错误回调\n     * @param error\n     * @private\n     */\n    _onError(error) {\n        console.log(`[[ReportPointRequestTask]请求发生错误:${error}]`);\n        if (this.callback !== null) {\n            let resBody = {};\n            resBody.infoCode = 2; //超时\n            resBody.data = \"网络错误\";\n\n            this.callback(resBody);\n        }\n    }\n}\n\nmodule.exports = ReportPointRequestTask;\n"]}